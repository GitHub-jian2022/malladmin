{"version":3,"sources":["store/action/usersAction.js","utils/Tool.js","pages/Login.jsx","utils/urls.js","utils/request.js","api/api.js"],"names":["login","phone","password","dispatch","a","axios","post","Api","res","action","type","LOGIN","data","Cookie","setItem","JSON","stringify","getUserInfo","token","localStorage","GET_USER_INFO","CryptoJS","require","key","encrypt","text","AES","toString","Login","props","state","trim","length","fail","store","subscribe","getState","usersReducer","history","push","style","position","height","className","onClick","value","this","placeholder","clear","onChange","setState","Component","withRouter","connect","REACT_APP_API_URL","process","REACT_APP_STATIC_URL","Axios","create","baseURL","interceptors","request","use","config","loading","timeout","getItem","headers","error","console","log","hide","Promise","reject","response","code","msg","register","getBanners","getNavs","getAdverts","getCate","getCartList","getGoodsList","getGoodInfo","getOrderList"],"mappings":"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","file":"static/js/16.4bf64a12.chunk.js","sourcesContent":["import { LOGIN } from '../actionType/usersType'\r\nimport { GET_USER_INFO } from '../actionType/usersType'\r\nimport { Api, axios } from '../../api/api'\r\nimport { Cookie } from '../../utils/storage'\r\n\r\nexport const login = ({phone,password}) => async(dispatch)=>{\r\n    const res = await axios.post(Api.login,{phone,password})\r\n    // console.log('res',res)\r\n    const action = {\r\n        type: LOGIN,\r\n        data: res.data\r\n    }\r\n    dispatch(action)\r\n    Cookie.setItem('token',JSON.stringify(res.data),2)\r\n    dispatch(getUserInfo(res.data))\r\n}\r\n\r\nexport const getUserInfo = (token) => async(dispatch)=>{\r\n    const res = await axios.post(Api.getUserInfo,{token})\r\n    // console.log('res',res)\r\n    const { data } = res\r\n    localStorage.setItem('user',JSON.stringify(data))\r\n    const action = {\r\n        type: GET_USER_INFO,\r\n        data\r\n    }\r\n    dispatch(action)\r\n}","const CryptoJS = require(\"crypto-js\");\r\n\r\nconst key = 'useyourkey'\r\n\r\n// Encrypt 加密\r\nexport function encrypt(text){\r\n  return CryptoJS.AES.encrypt(text, key).toString();\r\n}\r\n\r\n\r\n// Decrypt 解密\r\nexport function decrypt(cipherText){\r\n  let bytes = CryptoJS.AES.decrypt(cipherText, key);\r\n  return bytes.toString(CryptoJS.enc.Utf8);\r\n}\r\n\r\n","import React, { Component } from 'react'\r\nimport { InputItem, Toast } from 'antd-mobile';\r\nimport { withRouter } from 'react-router-dom'\r\nimport \"../assets/styles/Login.scss\"\r\n\r\nimport { connect } from \"react-redux\";\r\nimport { login } from '../store/action/usersAction'\r\nimport store from '../store'\r\nimport { encrypt } from '../utils/Tool'\r\n\r\nclass Login extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    store.subscribe(() => {\r\n      // const { token, user } = state.usersReducer\r\n      const { token } = store.getState().usersReducer\r\n      // console.log('token',token)\r\n      if(token) {\r\n        this.props.history.push('/index')\r\n      }\r\n    })\r\n    this.state = {\r\n      phone: '10086100108',\r\n      password: '123456'\r\n    }\r\n  }\r\n\r\n  login = async () => {\r\n    const { phone, password } = this.state;\r\n    if(phone.trim() == '' || phone.length < 11) {\r\n      Toast.fail('手机号格式不正确',1)\r\n      return\r\n    }\r\n    if(password.trim() == '') {\r\n      Toast.fail('密码不能为空',1)\r\n      return\r\n    }else if(password.length < 6) {\r\n      Toast.fail('密码长度应不小于6位数',1)\r\n      return\r\n    }\r\n    this.props.login({ phone, password: encrypt(password) })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ position: 'relative', height: '100vh' }}>\r\n        <div className='bg'>\r\n          {/* <span onClick={() => this.props.history.go(-1)}>X</span> */}\r\n        </div>\r\n        <div className='login'>\r\n          <div className='registered'>\r\n            <h3>登录</h3>\r\n            <span onClick={()=>{\r\n              this.props.history.push('/register')\r\n            }}>点此注册</span>\r\n          </div>\r\n\r\n          <div className='phone'>\r\n            <InputItem\r\n              value={this.state.phone}\r\n              placeholder=\"手机号\"\r\n              clear\r\n              onChange={phone => this.setState({ phone })}\r\n            ></InputItem>\r\n          </div>\r\n          <div className='password'>\r\n            <InputItem\r\n              value={this.state.password}\r\n              type='password'\r\n              placeholder=\"请输入密码\"\r\n              clear\r\n              onChange={password => this.setState({ password })}\r\n            ></InputItem>\r\n          </div>\r\n          {/* <div className='yzm'>\r\n            短信验证码登录\r\n          </div> */}\r\n          <div className='login_btn' onClick={this.login}>\r\n            登录\r\n          </div>\r\n          <div className='login_forget'>\r\n            已有账号，忘记密码？\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    login: (value) => {\r\n      dispatch(login(value))\r\n    }\r\n  }\r\n}\r\nexport default withRouter(connect(null, mapDispatchToProps)(Login))","/* \r\n    接口访问的前缀\r\n    静态资源访问的前缀\r\n*/\r\n\r\nconst REACT_APP_API_URL = process.env.REACT_APP_API_URL\r\n\r\nconst REACT_APP_STATIC_URL = process.env.REACT_APP_STATIC_URL\r\n\r\nexport  {\r\n    REACT_APP_API_URL,\r\n    REACT_APP_STATIC_URL\r\n}","\r\nimport Axios from \"axios\"\r\nimport { REACT_APP_API_URL } from \"./urls\";\r\nimport { Toast } from 'antd-mobile'\r\nimport { Cookie } from './storage'\r\n\r\n//1.添加通用前缀\r\nconst axios = Axios.create({\r\n    baseURL: REACT_APP_API_URL,\r\n  });\r\n//2.添加请求和返回的拦截\r\n//3.加遮罩\r\naxios.interceptors.request.use(function (config) {\r\n    Toast.loading('Loading...', 0, null,true);\r\n    config.timeout = 20000;\r\n    const token = Cookie.getItem('token') || ''\r\n    if(token) {\r\n      config.headers['Authorization'] = 'Bearer ' + token\r\n    }\r\n    return config;\r\n  }, function (error) {\r\n    console.log('error: ', error);\r\n    // Do something with request error\r\n    Toast.hide();\r\n    return Promise.reject(error);\r\n  });\r\n\r\n// Add a response interceptor\r\naxios.interceptors.response.use(function (response) {\r\n    Toast.hide();\r\n    console.log('response.data: ', response.data);\r\n    if(response.data.code === 403){\r\n      Toast.fail(response.data.msg, 2, null, true)\r\n\r\n    }else if(response.data.code === 500){\r\n      Toast.fail(response.data.msg, 2, null, true)\r\n      \r\n    }\r\n    return response.data;\r\n\r\n  }, function (error) {\r\n    // Toast.fail('请求失败', 2, null, true)\r\n    Toast.fail(error.response.msg, 2, null, true)\r\n    return Promise.reject(error);\r\n  });\r\n\r\n\r\nexport default axios","import axios from '../utils/request'\r\n\r\nconst Api = {\r\n    login: '/user/login',\r\n    register: '/user/register',\r\n    getUserInfo: '/user/getUserInfo',\r\n\r\n    getBanners: '/home/getBanners',\r\n    getNavs: '/home/getNavs',\r\n    getAdverts: '/home/getAdverts',\r\n\r\n    getCate: '/cate',\r\n\r\n    getCartList: '/alliance/cartList',\r\n\r\n    getGoodsList: '/goods/list',\r\n    getGoodInfo: '/alliance/goodInfo',\r\n    getOrderList: '/alliance/order/list',\r\n}\r\n\r\nexport {\r\n    Api,\r\n    axios\r\n}"],"sourceRoot":""}